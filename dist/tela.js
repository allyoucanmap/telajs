!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.tela=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var _require=require("./utils"),rad=_require.rad,Vector=require("./vector"),Matrix=require("./matrix"),Camera=function(p){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p.started?(this.id=p.cameras.length,this.position=new Vector([0,0,5]),this.target=new Vector([0,0,0]),this.up=new Vector([0,1,0]),this.direction=Vector.normalize(Vector.sub(this.target,this.position)),this.type="p",this.fov=70,this.aspect=p.w/p.h,this.near=.5,this.far=1e3,this.zoom=100,this.projection=new Matrix,this.view=new Matrix,this.w=p.w,this.h=p.h,this.update(options),this.at(options),p.cameras.push(this),this):null};Camera.prototype.update=function(op){if(void 0!==op){var opts={ty:"type",fo:"fov",as:"aspect",w:"w",h:"h",z:"zoom",ne:"near",fa:"far"};for(var o in opts)void 0!==op[o]&&(this[opts[o]]=op[o])}"p"===this.type?this.projection.all(Matrix.per(rad(this.fov),this.aspect,this.near,this.far)):"o"===this.type&&this.projection.all(Matrix.ort(-this.w/2/this.zoom,this.w/2/this.zoom,-this.h/2/this.zoom,this.h/2/this.zoom,this.near,this.far))},Camera.prototype.at=function(op){if(void 0!==op){var opts={p:"position",ta:"target",up:"up"};for(var o in opts)void 0!==op[o]&&this[opts[o]].all(op[o])}this.direction=Vector.normalize(Vector.sub(this.target,this.position)),this.view.all(Matrix.at(this.position.vs,this.target.vs,this.up.vs))},Camera.prototype.p=function(p){return void 0!==p&&(this.position.all(p),this.at()),this.position.all()},Camera.prototype.px=function(x){return void 0!==x&&(this.position.x(x),this.at()),this.position.x()},Camera.prototype.py=function(y){return void 0!==y&&(this.position.y(y),this.at()),this.position.y()},Camera.prototype.pz=function(z){return void 0!==z&&(this.position.z(z),this.at()),this.position.z()},Camera.prototype.ta=function(ta){return void 0!==ta&&(this.target.all(ta),this.at()),this.target.all()},Camera.prototype.fo=function(fo){return"p"!==this.type?null:(void 0!==fo&&(this.fov=fo,this.update()),this.fov)},Camera.prototype.z=function(z){return"o"!==this.type?null:(void 0!==z&&(this.zoom=z,this.update()),this.zoom)},Camera.prototype.ne=function(ne){return void 0!==ne&&(this.near=ne,this.update()),this.near},Camera.prototype.fa=function(fa){return void 0!==fa&&(this.far=fa,this.update()),this.far},module.exports=Camera},{"./matrix":8,"./utils":13,"./vector":14}],2:[function(require,module,exports){"use strict";var Vector=require("./vector"),Model=require("./model"),Entity=function(p){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!p.started)return null;this.id=p.entities.length,this.name="",this.model=null,this.material=0,this.lwidth=1,this.color=new Vector([.5,.4,.6]),this.specular=new Vector([1,1,1]),this.origin=new Vector([0,0,0]),this.position=new Vector([0,0,0]),this.rotation=new Vector([0,0,0]),this.scale=new Vector([1,1,1]),this.rsort=["rx","ry","rz"],this.hide=!1,this.value=1;var opts={c:"c",mod:"mod",ma:"ma",n:"n",o:"o",p:"p",r:"r",rs:"rs",s:"s",sp:"sp",va:"va"};for(var o in opts)void 0!==options[o]&&this[opts[o]](options[o]);return p.entities.push(this),this};Entity.prototype.mod=function(mod){return void 0!==mod&&null===this.model&&(mod.t?this.model=new Model(mod):this.model=mod,this.model.ent(this)),this.model},Entity.prototype.ma=function(ma){return void 0!==ma&&(this.material=ma),this.material},Entity.prototype.n=function(n){return void 0!==n&&(this.name=n),this.name},Entity.prototype.sp=function(s){return void 0!==s&&(s.length>1?this.specular.all(s):this.specular.all([s,s,s])),this.specular.all()},Entity.prototype.c=function(c){return void 0!==c&&(c.length>1?this.color.all(c):this.color.all([c,c,c])),this.color.all()},Entity.prototype.cr=function(r){return void 0!==r&&this.color.x(r),this.color.x()},Entity.prototype.cg=function(g){return void 0!==g&&this.color.y(g),this.color.y()},Entity.prototype.cb=function(b){return void 0!==b&&this.color.z(b),this.color.z()},Entity.prototype.o=function(o){return void 0!==o&&this.origin.all(o),this.origin.all()},Entity.prototype.p=function(p){return void 0!==p&&this.position.all(p),this.position.all()},Entity.prototype.px=function(x){return void 0!==x&&this.position.x(x),this.position.x()},Entity.prototype.py=function(y){return void 0!==y&&this.position.y(y),this.position.y()},Entity.prototype.pz=function(z){return void 0!==z&&this.position.z(z),this.position.z()},Entity.prototype.r=function(r){return void 0!==r&&(this.rotation.vs=[r[0]%360,r[1]%360,r[2]%360]),this.rotation.all()},Entity.prototype.rx=function(x){return void 0!==x&&(this.rotation.vs[0]=x%360),this.rotation.x()},Entity.prototype.ry=function(y){return void 0!==y&&(this.rotation.vs[1]=y%360),this.rotation.y()},Entity.prototype.rz=function(z){return void 0!==z&&(this.rotation.vs[2]=z%360),this.rotation.z()},Entity.prototype.rs=function(s){return void 0!==s&&(this.rsort=s),this.rsort},Entity.prototype.s=function(s){return void 0!==s&&(s.length>1?this.scale.all(s):this.scale.all([s,s,s])),this.scale.all()},Entity.prototype.sx=function(x){return void 0!==x&&this.scale.x(x),this.scale.x()},Entity.prototype.sy=function(y){return void 0!==y&&this.scale.y(y),this.scale.y()},Entity.prototype.sz=function(z){return void 0!==z&&this.scale.z(z),this.scale.z()},Entity.prototype.li=function(){return this.mod().line},Entity.prototype.lw=function(w){return void 0!==w&&(this.lwidth=w),this.lwidth},Entity.prototype.hi=function(h){return void 0!==h&&(this.hide=h),this.hide},Entity.prototype.va=function(v){return void 0!==v&&(this.value=v),this.value},Entity.prototype.ko=function(){this.model.budelete()},module.exports=Entity},{"./model":9,"./vector":14}],3:[function(require,module,exports){"use strict";var _require=require("./utils"),map=_require.map,Event=function(p,ty,f){return this.e=p.e,this.canvas=p.canvas,this.extensions=p.extensions,this.bbox=p.bbox,this.type=ty,this.f=f,this.events=[],this.block=!1,this.type&&this[this.type]?this[this.type](this.f):null};Event.prototype.click=function(f){var _this=this;this.canvas.addEventListener&&!this.block&&(this.events.push(function(e){f&&f([e.clientX-_this.bbox.left,e.clientY-_this.bbox.top],e),_this.extensions.forEach(function(ext){ext.data.events&&ext.data.events.click&&ext.data.events.click([e.clientX-_this.bbox.left,e.clientY-_this.bbox.top],ext,e)}),_this.e.click=!0}),this.canvas.addEventListener("click",this.events[0],!1)),this.block=!0},Event.prototype.move=function(f){var _this2=this;this.canvas.addEventListener&&!this.block&&(this.events.push(function(e){f&&f([e.clientX-_this2.bbox.left,e.clientY-_this2.bbox.top],e),_this2.extensions.forEach(function(ext){ext.data.events&&ext.data.events.move&&ext.data.events.move([e.clientX-_this2.bbox.left,e.clientY-_this2.bbox.top],ext,e)}),_this2.e.move=!0}),this.canvas.addEventListener("mousemove",this.events[0],!1)),this.block=!0},Event.prototype.scroll=function(f){var _this3=this;this.canvas.addEventListener&&!this.block&&(this.events.push(function(e){var ev=-e.detail||e.wheelDelta;ev=map(ev,-Math.abs(ev),Math.abs(ev),-1,1),f&&f(ev,[e.clientX-_this3.bbox.left,e.clientY-_this3.bbox.top],e),_this3.extensions.forEach(function(ext){ext.data.events&&ext.data.events.scroll&&ext.data.events.scroll(ev,[e.clientX-_this3.bbox.left,e.clientY-_this3.bbox.top],ext,e)}),_this3.e.scroll=!0}),this.canvas.addEventListener("mousewheel",this.events[0],!1),this.canvas.addEventListener("DOMMouseScroll",this.events[0],!1)),this.block=!0},Event.prototype.drag=function(f){var _this4=this;this.canvas.addEventListener&&!this.block&&(this.start=!1,this.point=[],this.events.push(function(e){e.button>=0&&(_this4.start=!0,_this4.point=[e.clientX-_this4.bbox.left,e.clientY-_this4.bbox.top],_this4.e.dragstart=!0)}),this.events.push(function(e){e.button>=0&&_this4.start&&(f&&f([e.clientX-_this4.bbox.left-_this4.point[0],e.clientY-_this4.bbox.top-_this4.point[1]],e),_this4.extensions.forEach(function(ext){ext.data.events&&ext.data.events.drag&&ext.data.events.drag([e.clientX-_this4.bbox.left-_this4.point[0],e.clientY-_this4.bbox.top-_this4.point[1]],ext,e)}),_this4.point=[e.clientX-_this4.bbox.left,e.clientY-_this4.bbox.top],_this4.e.drag=!0)}),this.events.push(function(e){e.button>=0&&_this4.start&&(_this4.start=!1,_this4.e.dragend=!0)}),this.canvas.addEventListener("mousedown",this.events[0],!1),this.canvas.addEventListener("mousemove",this.events[1],!1),this.canvas.addEventListener("mouseup",this.events[2],!1)),this.block=!0},module.exports=Event},{"./utils":13}],4:[function(require,module,exports){"use strict";var Extension=function(p){var ext=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.data=ext,p.extensions.push(this),this};Extension.prototype.set=function(k,v){k&&null!==v&&(this.data.settings[k]=v)},Extension.prototype.get=function(k){return k?this.data.settings[k]:null},module.exports=Extension},{}],5:[function(require,module,exports){"use strict";module.exports="precision highp float;uniform vec3 diffuse;uniform vec3 specular;uniform vec3 lcolor;uniform int material;uniform float value;uniform float time;varying vec2 vT;varying vec3 vC;varying vec3 suN;varying vec3 toL;float random(in vec2 vT) {return fract(sin(dot(vT, vec2(12.9898, 78.233))) * 43758.5453123);}void main(void) {vec4 color;if (vC.x >= 0.0 && vC.x <= 1.0) {color = vec4(vC, 1.0);} else {color = vec4(diffuse, 1.0);}float brightness = 1.0;if (material == 0) {brightness = max(dot(normalize(suN), normalize(toL)), 0.4);color *= vec4(vec3(brightness), 1.0);} else if (material == 1) {brightness = max(dot(normalize(suN + vec3(random(vT))), normalize(toL)), 0.4);color *= vec4(vec3(brightness), 1.0);} else if (material == 2) {brightness = max(dot(normalize(suN), normalize(toL)), 0.4);color *= vec4(vec3(brightness), 1.0);color += vec4(vec3(abs(sin(time * value))), 1.0) * vec4(specular, 1.0);} else if (material > 2 && material < 9) {float noise = 1.0;if (material == 3) {noise = mod((vT.x) * 20.0 * value, 2.0);} else if (material == 4) {noise = mod((vT.y) * 20.0 * value, 2.0);} else if (material == 5) {noise = mod((vT.x + vT.y) * 20.0 * value, 2.0);} else if (material == 6) {noise = mod((vT.x - vT.y) * 20.0 * value, 2.0);} else if (material == 7) {noise = mod((vT.x * vT.y) * 20.0 * value, 2.0);} else if (material == 8) {noise = mod((vT.x / vT.y) * 20.0 * value, 2.0);}if (noise > 1.1) {noise = 1.0;} else {noise = 0.4;}brightness = max(dot(normalize(suN + noise), normalize(toL)), 0.4);color *= vec4(vec3(brightness), 1.0);}color *= vec4(lcolor * brightness, 1.0);gl_FragColor = color;}"},{}],6:[function(require,module,exports){"use strict";var Vector=require("./vector"),Light=function(p){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!p.started)return null;this.id=p.lights.length,this.color=new Vector([1,1,1]),this.position=new Vector([0,0,100]);var opts={c:"c",p:"p"};for(var o in opts)void 0!==options[o]&&this[opts[o]](options[o]);return p.lights.push(this),this};Light.prototype.c=function(c){return void 0!==c&&(c.length>1?this.color.all(c):this.color.all([c,c,c])),this.color.all()},Light.prototype.cr=function(r){return void 0!==r&&this.color.x(r),this.color.x()},Light.prototype.cg=function(g){return void 0!==g&&this.color.y(g),this.color.y()},Light.prototype.cb=function(b){return void 0!==b&&this.color.z(b),this.color.z()},Light.prototype.p=function(p){return void 0!==p&&this.position.all(p),this.position.all()},Light.prototype.px=function(x){return void 0!==x&&this.position.x(x),this.position.x()},Light.prototype.py=function(y){return void 0!==y&&this.position.y(y),this.position.y()},Light.prototype.pz=function(z){return void 0!==z&&this.position.z(z),this.position.z()},module.exports=Light},{"./vector":14}],7:[function(require,module,exports){"use strict";var tela=void 0;!function(){var _this=this,T=function(){};T.prototype._={},T.prototype._.started=!1,T.prototype._.spath="shader/",T.prototype._.extensions=[],T.prototype.set=function(id){return T.prototype._.started?null:(T.prototype._.divpi=document.createElement("div"),T.prototype._.divpi.style.position="absolute",T.prototype._.divpi.style.left="-100%",T.prototype._.divpi.style.top="-100%",T.prototype._.divpi.style.width="1in",T.prototype._.divpi.style.height="1in",document.body.appendChild(T.prototype._.divpi),T.prototype._.dpi={},T.prototype._.dpi.x=T.prototype._.divpi.offsetWidth,T.prototype._.dpi.y=T.prototype._.divpi.offsetHeight,T.prototype._.canvas=document.getElementById(id),T.prototype._.canvas.setAttribute("oncontextmenu","return false"),T.prototype._.canvas.setAttribute("width",T.prototype._.canvas.clientWidth),T.prototype._.canvas.setAttribute("height",T.prototype._.canvas.clientHeight),T.prototype._.gl=T.prototype._.canvas.getContext("webgl")||T.prototype._.canvas.getContext("experimental-webgl"),T.prototype._.gl?(T.prototype._.started=!0,T.prototype._.w=T.prototype._.canvas.width,T.prototype._.h=T.prototype._.canvas.height,T.prototype._.gl.viewport(0,0,T.prototype._.w,T.prototype._.h),T.prototype._.stp=!1,T.prototype._.timeout=null,T.prototype._.draw=null,T.prototype._.fps=60,T.prototype._.r=null,T.prototype._.shaders=[],T.prototype._.models=[],T.prototype._.entities=[],T.prototype._.cameras=[],T.prototype._.lights=[],T.prototype._.bbox=T.prototype._.canvas.getBoundingClientRect(),T.prototype._.e={},T.prototype._.e.move=!1,T.prototype._.e.click=!1,T.prototype._.e.scroll=!1,T.prototype._.e.dragstart=!1,T.prototype._.e.drag=!1,T.prototype._.e.dragend=!1,T.prototype._.e.resize=!1,T.prototype._.stt={},T.prototype._.stt.ids=0,T.prototype._.stt.idc=0,T.prototype._.stt.idl=0,T.prototype._.time=0,T.prototype._.SQRT3=Math.sqrt(3),T.prototype._.extensions.forEach(function(ext){ext.data.set&&ext.data.set.now&&ext.data.set.now(ext,tela)}),_this):null)},T.prototype.play=function(f,o){return T.prototype._.started?(null===T.prototype._.r&&(T.prototype._.r=new T.prototype.Render(T.prototype._,o)),T.prototype.draw=function(){if(!T.prototype._.stp){T.prototype._.extensions.forEach(function(ext){ext.data.play&&ext.data.play.before&&ext.data.play.before(ext,tela)}),T.prototype._.timeout=window.setTimeout(function(){window.requestAnimationFrame(T.prototype.draw)},1e3/T.prototype._.fps),f&&f(),T.prototype._.extensions.forEach(function(ext){ext.data.play&&ext.data.play.now&&ext.data.play.now(ext,tela)}),T.prototype._.r.update(T.prototype._.models);for(var e in T.prototype._.e)T.prototype._.e[e]&&(T.prototype._.e[e]=!1);T.prototype._.time+=.05,T.prototype._.extensions.forEach(function(ext){ext.data.play&&ext.data.play.after&&ext.data.play.after(ext,tela)})}},T.prototype.draw(),"play"):null},T.prototype.pause=function(){return T.prototype._.started?(T.prototype._.stp=!T.prototype._.stp,T.prototype.draw(),"pause"):null},T.prototype.stop=function(){if(!T.prototype._.started)return null;T.prototype._.stp=!0,window.clearTimeout(T.prototype._.timeout),T.prototype._.resizeid&&window.clearTimeout(T.prototype._.resizeid);for(var m=0;m<T.prototype._.models.length;m++)T.prototype._.models[m].destroy();return T.prototype._.r.destroy(T.prototype._.shaders),"stop"},T.prototype.resize=function(f){return T.prototype._.started?(T.prototype._.resizeid=null,window.addEventListener("resize",function(){window.clearTimeout(T.prototype._.resizeid),T.prototype._.resizeid=window.setTimeout(function(){T.prototype._.canvas.setAttribute("width",T.prototype._.canvas.clientWidth),T.prototype._.canvas.setAttribute("height",T.prototype._.canvas.clientHeight),T.prototype._.w=T.prototype._.canvas.width,T.prototype._.h=T.prototype._.canvas.height,T.prototype._.bbox=T.prototype._.canvas.getBoundingClientRect(),T.prototype._.gl.viewport(0,0,T.prototype._.w,T.prototype._.h);for(var c in T.prototype._.cameras)T.prototype._.cameras[c]&&T.prototype._.cameras[c].update({h:T.prototype._.h,w:T.prototype._.w,as:T.prototype._.w/T.prototype._.h});f&&f(),T.prototype._.extensions.forEach(function(ext){ext.data.resize&&ext.data.resize.now&&ext.data.resize.now(ext,tela)})},500),T.prototype._.e.resize=!0},!1),"resize"):null},T.prototype.get=function(k){return T.prototype._[k]?T.prototype._[k]:null},T.prototype.Shader=require("./shader"),T.prototype.Model=require("./model"),T.prototype.Entity=require("./entity"),T.prototype.Camera=require("./camera"),T.prototype.Light=require("./light"),T.prototype.Render=require("./render"),T.prototype.Extension=require("./extension"),T.prototype.Event=require("./event"),tela=new T,tela.sha=function(o){return new tela.Shader(T.prototype._,o)},tela.mod=function(o){return new tela.Model(T.prototype._,o)},tela.ent=function(o){return new tela.Entity(T.prototype._,o)},tela.cam=function(o){return new tela.Camera(T.prototype._,o)},tela.lig=function(o){return new tela.Light(T.prototype._,o)},tela.ren=function(o){return new tela.Render(T.prototype._,o)},tela.ext=function(ext){return new tela.Extension(T.prototype._,ext)},tela.on=function(ty,f){return new tela.Event(T.prototype._,ty,f)},window.addEventListener("beforeunload",function(){tela.stop()},!1),window.addEventListener("unload",function(){tela.stop()},!1)}(),module.exports=tela},{"./camera":1,"./entity":2,"./event":3,"./extension":4,"./light":6,"./model":9,"./render":10,"./shader":11}],8:[function(require,module,exports){"use strict";var _require=require("./utils"),rad=_require.rad,identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Matrix=function(){var mx=arguments.length>0&&void 0!==arguments[0]?arguments[0]:identity;return this.mx=mx,this};Matrix.prototype.all=function(mx){return void 0!==mx&&(this.mx=mx),this.mx},Matrix.prototype.m=function(i,m){return void 0!==m&&(this.mx[i]=m),this.mx[i]},Matrix.at=function(ey,ce,up){if(Math.abs(ey[0]-ce[0])<1e-6&&Math.abs(ey[1]-ce[1])<1e-6&&Math.abs(ey[2]-ce[2])<1e-6)return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var z0=ey[0]-ce[0],z1=ey[1]-ce[1],z2=ey[2]-ce[2],len=1/Math.sqrt(z0*z0+z1*z1+z2*z2);z0*=len,z1*=len,z2*=len;var x0=up[1]*z2-up[2]*z1,x1=up[2]*z0-up[0]*z2,x2=up[0]*z1-up[1]*z0;len=Math.sqrt(x0*x0+x1*x1+x2*x2),len?(len=1/len,x0*=len,x1*=len,x2*=len):(x0=0,x1=0,x2=0);var y0=z1*x2-z2*x1,y1=z2*x0-z0*x2,y2=z0*x1-z1*x0;return len=Math.sqrt(y0*y0+y1*y1+y2*y2),len?(len=1/len,y0*=len,y1*=len,y2*=len):(y0=0,y1=0,y2=0),[x0,y0,z0,0,x1,y1,z1,0,x2,y2,z2,0,-(x0*ey[0]+x1*ey[1]+x2*ey[2]),-(y0*ey[0]+y1*ey[1]+y2*ey[2]),-(z0*ey[0]+z1*ey[1]+z2*ey[2]),1]},Matrix.per=function(fo,as,ne,fa){var f=1/Math.tan(fo/2),nf=1/(ne-fa);return[f/as,0,0,0,0,f,0,0,0,0,(fa+ne)*nf,-1,0,0,2*fa*ne*nf,0]},Matrix.ort=function(le,ri,bo,to,ne,fa){var lr=1/(le-ri),bt=1/(bo-to),nf=1/(ne-fa);return[-2*lr,0,0,0,0,-2*bt,0,0,0,0,2*nf,0,(le+ri)*lr,(to+bo)*bt,(fa+ne)*nf,1]},Matrix.frot=function(an,ax){var s=Math.sin(an),c=Math.cos(an),mx=[];switch(ax){case"rx":mx=[1,0,0,0,0,c,s,0,0,-s,c,0,0,0,0,1];break;case"ry":mx=[c,0,-s,0,0,1,0,0,s,0,c,0,0,0,0,1];break;case"rz":mx=[c,s,0,0,-s,c,0,0,0,0,1,0,0,0,0,1];break;default:mx=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}return new Matrix(mx)},Matrix.translate=function(mx,v){return new Matrix([mx.m(0),mx.m(1),mx.m(2),mx.m(3),mx.m(4),mx.m(5),mx.m(6),mx.m(7),mx.m(8),mx.m(9),mx.m(10),mx.m(11),mx.m(0)*v[0]+mx.m(4)*v[1]+mx.m(8)*v[2]+mx.m(12),mx.m(1)*v[0]+mx.m(5)*v[1]+mx.m(9)*v[2]+mx.m(13),mx.m(2)*v[0]+mx.m(6)*v[1]+mx.m(10)*v[2]+mx.m(14),mx.m(3)*v[0]+mx.m(7)*v[1]+mx.m(11)*v[2]+mx.m(15)])},Matrix.mul=function(ma,mb){return new Matrix([mb.m(0)*ma.m(0)+mb.m(1)*ma.m(4)+mb.m(2)*ma.m(8)+mb.m(3)*ma.m(12),mb.m(0)*ma.m(1)+mb.m(1)*ma.m(5)+mb.m(2)*ma.m(9)+mb.m(3)*ma.m(13),mb.m(0)*ma.m(2)+mb.m(1)*ma.m(6)+mb.m(2)*ma.m(10)+mb.m(3)*ma.m(14),mb.m(0)*ma.m(3)+mb.m(1)*ma.m(7)+mb.m(2)*ma.m(11)+mb.m(3)*ma.m(15),mb.m(4)*ma.m(0)+mb.m(5)*ma.m(4)+mb.m(6)*ma.m(8)+mb.m(7)*ma.m(12),mb.m(4)*ma.m(1)+mb.m(5)*ma.m(5)+mb.m(6)*ma.m(9)+mb.m(7)*ma.m(13),mb.m(4)*ma.m(2)+mb.m(5)*ma.m(6)+mb.m(6)*ma.m(10)+mb.m(7)*ma.m(14),mb.m(4)*ma.m(3)+mb.m(5)*ma.m(7)+mb.m(6)*ma.m(11)+mb.m(7)*ma.m(15),mb.m(8)*ma.m(0)+mb.m(9)*ma.m(4)+mb.m(10)*ma.m(8)+mb.m(11)*ma.m(12),mb.m(8)*ma.m(1)+mb.m(9)*ma.m(5)+mb.m(10)*ma.m(9)+mb.m(11)*ma.m(13),mb.m(8)*ma.m(2)+mb.m(9)*ma.m(6)+mb.m(10)*ma.m(10)+mb.m(11)*ma.m(14),mb.m(8)*ma.m(3)+mb.m(9)*ma.m(7)+mb.m(10)*ma.m(11)+mb.m(11)*ma.m(15),mb.m(12)*ma.m(0)+mb.m(13)*ma.m(4)+mb.m(14)*ma.m(8)+mb.m(15)*ma.m(12),mb.m(12)*ma.m(1)+mb.m(13)*ma.m(5)+mb.m(14)*ma.m(9)+mb.m(15)*ma.m(13),mb.m(12)*ma.m(2)+mb.m(13)*ma.m(6)+mb.m(14)*ma.m(10)+mb.m(15)*ma.m(14),mb.m(12)*ma.m(3)+mb.m(13)*ma.m(7)+mb.m(14)*ma.m(11)+mb.m(15)*ma.m(15)])},Matrix.scale=function(mx,v){return new Matrix([mx.m(0)*v[0],mx.m(1)*v[0],mx.m(2)*v[0],mx.m(3)*v[0],mx.m(4)*v[1],mx.m(5)*v[1],mx.m(6)*v[1],mx.m(7)*v[1],mx.m(8)*v[2],mx.m(9)*v[2],mx.m(10)*v[2],mx.m(11)*v[2],mx.m(12),mx.m(13),mx.m(14),mx.m(15)])},Matrix.mmx=function(ent){return Matrix.scale(Matrix.mul(Matrix.mul(Matrix.mul(Matrix.translate(new Matrix,ent.p()),Matrix.frot(rad(ent[ent.rsort[0]]()),ent.rsort[0])),Matrix.frot(rad(ent[ent.rsort[1]]()),ent.rsort[1])),Matrix.frot(rad(ent[ent.rsort[2]]()),ent.rsort[2])),ent.s())},Matrix.mvp=function(mmx,vmx,pmx){return Matrix.mul(Matrix.mul(pmx,vmx),mmx)},module.exports=Matrix},{"./utils":13}],9:[function(require,module,exports){"use strict";var _require=require("./utils"),perpendicular=_require.perpendicular,inside=_require.inside,convex=_require.convex,max=_require.max,min=_require.min,map=_require.map,Vector=require("./vector"),Model=function Model(p){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},opts={raw:"raw",str:"structure",ty:"type",cv:"cv"};if(!p.started)return null;this.id=p.models.length,this.line=0,this.del=!1,this.entities=[],this.type="CUB",this.gl=p.gl,this.vs={i:[],p:[],t:[],n:[],c:[]},this.bu={i:null,p:null,t:null,n:null};for(var o in opts)void 0!==options[o]&&(this[opts[o]]=options[o]);switch(this.type){case"WGL":this.vs={i:[0,1,2],p:[0,p.SQRT3/3,0,-.5,-p.SQRT3/6,0,.5,-p.SQRT3/6,0],t:[.5,p.SQRT3/2,0,0,1,0],n:[0,0,1,0,0,1,0,0,1],c:[1,0,0,0,1,0,0,0,1]};break;case"EQU":this.vs={i:[0,1,2],p:[0,p.SQRT3/3,0,-.5,-p.SQRT3/6,0,.5,-p.SQRT3/6,0],t:[.5,p.SQRT3/2,0,0,1,0],n:[0,0,1,0,0,1,0,0,1],c:[-1,-1,-1,-1,-1,-1,-1,-1,-1]};break;case"TRI":this.vs={i:[0,1,2],p:[-.5,.5,0,-.5,-.5,0,.5,.5,0],t:[0,1,0,0,1,1],n:[0,0,1,0,0,1,0,0,1],c:[-1,-1,-1,-1,-1,-1,-1,-1,-1]};break;case"REC":this.vs={i:[0,1,3,3,1,2],p:[-.5,.5,0,-.5,-.5,0,.5,-.5,0,.5,.5,0],t:[0,1,0,0,1,0,1,1],n:[0,0,1,0,0,1,0,0,1,0,0,1],c:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]};break;case"CUB":this.vs={i:[0,1,3,3,1,2,4,5,7,7,5,6,8,9,11,11,9,10,12,13,15,15,13,14,16,17,19,19,17,18,20,21,23,23,21,22],p:[-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5],t:[0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],n:[0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],c:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]};break;case"STR":this.vs=this.structure;break;case"PLL":this.line=1,this.vs=Model.polylines(this.raw,this.cv);break;case"PLG":this.vs=Model.polygons(this.raw,this.cv)}return this.bucreate(),this.bubind(),p.models.push(this),this};Model.prototype.size=function(){return this.vs.i.length},Model.prototype.ent=function(e){return void 0!==e&&this.entities.push(e),this.entities},Model.prototype.bucreate=function(){this.del=!1,this.bu.i=this.gl.createBuffer(),this.bu.p=this.gl.createBuffer(),this.bu.t=this.gl.createBuffer(),this.bu.n=this.gl.createBuffer(),void 0!==this.vs.c&&(this.bu.c=this.gl.createBuffer())},Model.prototype.bubind=function(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.bu.i),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.vs.i),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.bu.p),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.vs.p),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.bu.t),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.vs.t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.bu.n),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.vs.n),this.gl.STATIC_DRAW),void 0!==this.vs.c&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.bu.c),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.vs.c),this.gl.STATIC_DRAW))},Model.prototype.budelete=function(){this.del=!0,this.gl.deleteBuffer(this.bu.i),this.gl.deleteBuffer(this.bu.p),this.gl.deleteBuffer(this.bu.t),this.gl.deleteBuffer(this.bu.n),void 0!==this.vs.c&&(this.gl.deleteBuffer(this.bu.c),this.bu.c=null),this.bu.i=null,this.bu.p=null,this.bu.t=null,this.bu.n=null},Model.prototype.destroy=function(){this.del||this.budelete()},Model.polylines=function(rw,cv){for(var vs={i:[],p:[],t:[],n:[],c:[]},i=0,k=0;i<rw.length;i++)for(var j=0;j<rw[i].length-1;j++,k+=4){var ca=void 0,cb=void 0;cv&&(ca=cv[i][j],cb=cv[i][j+1]);var a=rw[i][j],b=rw[i][j+1],r=perpendicular(a,b,1),l=perpendicular(a,b,-1),d=.005;b[1]-a[1]<=0&&(b[0]-a[0]<0&&b[1]-a[1]==0||(d=-.005));var az=0,bz=0;void 0!==a[2]&&(az=a[2]),void 0!==b[2]&&(bz=b[2]),vs.i=vs.i.concat([k,k+1,k+3,k+3,k+1,k+2]),vs.p=vs.p.concat([a[0]+l[0]*d,a[1]+l[1]*d,az,a[0]+r[0]*d,a[1]+r[1]*d,az,b[0]+r[0]*d,b[1]+r[1]*d,bz,b[0]+l[0]*d,b[1]+l[1]*d,bz]),vs.t=vs.t.concat([0,0,1,0,1,1,0,1]),vs.n=vs.n.concat([l[0]*d,l[1]*d,1,r[0]*d,r[1]*d,1,r[0]*d,r[1]*d,1,l[0]*d,l[1]*d,1]),vs.c=cv?vs.c.concat([ca[0],ca[1],ca[2],ca[0],ca[1],ca[2],cb[0],cb[1],cb[2],cb[0],cb[1],cb[2]]):vs.c.concat([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}return vs},Model.polygons=function(rw,cv){for(var vs={i:[],p:[],t:[],n:[],c:[]},cnt=0,tmpmax=[],tmpmin=[],i=0;i<rw.length;i++)tmpmax.push([max(rw[i],"0"),max(rw[i],"1")]),tmpmin.push([min(rw[i],"0"),min(rw[i],"1")]);var minx=min(tmpmin,[0]),maxx=max(tmpmax,[0]),miny=min(tmpmin,[1]),maxy=max(tmpmax,[1]),tx=1,ty=1,ratio=(maxx-minx)/(maxy-miny);ratio>1?ty=1/ratio:tx=1*ratio;for(var _i=0;_i<rw.length;_i++){var p=rw[_i].map(function(a){return a.slice(0)}),c=void 0;for(cv&&(c=cv[_i].map(function(a){return a.slice(0)})[0]);p.length>2;){var e=Model.ear(p);if(p.splice(e[0],1),vs.i=vs.i.concat([cnt+1,cnt,cnt+2]),void 0!==e[1][2]&&void 0!==e[2][2]&&void 0!==e[3][2]){vs.p=vs.p.concat([e[1][0],e[1][1],e[1][2],e[2][0],e[2][1],e[2][2],e[3][0],e[3][1],e[3][2]]);var n=Vector.normalize(Vector.snormal(new Vector(e[3]),new Vector(e[2]),new Vector(e[1])));vs.n=vs.n.concat([n.x(),n.y(),n.z(),n.x(),n.y(),n.z(),n.x(),n.y(),n.z()])}else vs.p=vs.p.concat([e[1][0],e[1][1],0,e[2][0],e[2][1],0,e[3][0],e[3][1],0]),vs.n=vs.n.concat([0,0,1,0,0,1,0,0,1]);vs.t=vs.t.concat([map(e[1][0],minx,maxx,0,tx),map(e[1][1],miny,maxy,0,ty),map(e[2][0],minx,maxx,0,tx),map(e[2][1],miny,maxy,0,ty),map(e[3][0],minx,maxx,0,tx),map(e[3][1],miny,maxy,0,ty)]),vs.c=c?vs.c.concat([c[0],c[1],c[2],c[0],c[1],c[2],c[0],c[1],c[2]]):vs.c.concat([-1,-1,-1,-1,-1,-1,-1,-1,-1]),cnt+=3}}return vs},Model.ear=function(p){for(var e=[],i=0;i<p.length;i++){var ia=i-1,ib=i,ic=i+1,ch=!0;if(0===i&&(ia=p.length-1,ib=0,ic=1),i===p.length-1&&(ia=p.length-2,ib=p.length-1,ic=0),convex([p[ia],p[ib],p[ic]]))for(var j=0;j<p.length;j++)j!==ia&&j!==ib&&j!==ic&&inside(p[j],[p[ia],p[ib],p[ic],p[ia]])&&(ch=!1);if(ch){e=[ib,p[ia].slice(0),p[ib].slice(0),p[ic].slice(0)];break}}return e},module.exports=Model},{"./utils":13,"./vector":14}],10:[function(require,module,exports){"use strict";var Vector=require("./vector"),Matrix=require("./matrix"),Shader=require("./shader"),Camera=require("./camera"),Light=require("./light"),Render=function(p){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p.started&&null===p.r?(0===p.shaders.length?this.shader=new Shader(p,options.sha):this.shader=p.shaders[0],0===p.cameras.length?this.camera=new Camera(p,options.cam):this.camera=p.cameras[0],0===p.lights.length?this.light=new Light(p,options.lig):this.light=p.lights[0],this.clean=!1,this.background=new Vector([.9,.9,.9]),this.gl=p.gl,this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK),this.p=p,p.r=this,this):null};Render.prototype.sky=function(c){return void 0!==c&&this.background.all(c),this.background.all()},Render.prototype.sha=function(sha){return void 0!==sha&&(this.shader=sha),this.shader},Render.prototype.cam=function(cam){return void 0!==cam&&(this.camera=cam),this.camera},Render.prototype.lig=function(lig){return void 0!==lig&&(this.light=lig),this.light},Render.prototype.update=function(models){if(this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.clearColor(this.background.x(),this.background.y(),this.background.z(),1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.shader.ready()){this.shader.start(),this.shader.load("time",this.p.time),this.shader.load("light",this.light.p()),this.shader.load("lcolor",this.light.c());for(var i=0;i<models.length;i++)if(!models[i].del){this.gl.enableVertexAttribArray(0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,models[i].bu.p),this.gl.vertexAttribPointer(0,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(1),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,models[i].bu.t),this.gl.vertexAttribPointer(1,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(2),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,models[i].bu.n),this.gl.vertexAttribPointer(2,3,this.gl.FLOAT,!1,0,0),models[i].bu.c&&(this.gl.enableVertexAttribArray(3),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,models[i].bu.c),this.gl.vertexAttribPointer(3,3,this.gl.FLOAT,!1,0,0)),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,models[i].bu.i);for(var j=0;j<models[i].ent().length;j++)if(!models[i].ent()[j].hi()){var mmx=Matrix.mmx(models[i].ent()[j]),mvp=Matrix.mvp(mmx,this.camera.view,this.camera.projection);this.shader.load("diffuse",models[i].ent()[j].c()),this.shader.load("specular",models[i].ent()[j].sp()),this.shader.load("material",models[i].ent()[j].ma()),this.shader.load("value",models[i].ent()[j].va()),this.shader.load("line",models[i].ent()[j].li()),this.shader.load("lwidth",models[i].ent()[j].lw()),this.shader.load("origin",models[i].ent()[j].o()),this.shader.load("mmx",mmx.all()),this.shader.load("vmx",this.camera.view.all()),this.shader.load("pmx",this.camera.projection.all()),this.shader.load("mvp",mvp.all()),this.gl.drawElements(this.gl.TRIANGLES,models[i].size(),this.gl.UNSIGNED_SHORT,0)}this.gl.disableVertexAttribArray(0),this.gl.disableVertexAttribArray(1),this.gl.disableVertexAttribArray(2),models[i].bu.c&&this.gl.disableVertexAttribArray(3)}this.shader.stop()}},Render.prototype.destroy=function(shaders){if(!this.clean){for(var s in shaders.length)void 0!==shaders[s]&&shaders[s].destroy();this.clean=!0}},module.exports=Render},{"./camera":1,"./light":6,"./matrix":8,"./shader":11,"./vector":14}],11:[function(require,module,exports){"use strict";var _require=require("./utils"),getShadersFromFile=_require.getShadersFromFile,ShaderProgram=require("./shaderprogram"),Shader=function(p){var optns=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!p.started)return null;var options=optns;return this.name="_",void 0!==options.n&&(this.name=options.n),this.id=p.shaders.length,
this.vload=!1,this.fload=!1,this.vert="",this.frag="",this.attributes=[{pos:0,name:"p"},{pos:1,name:"t"},{pos:2,name:"n"},{pos:3,name:"c"}],this.uniforms={mvp:{type:"mat4",name:"mvp"},mmx:{type:"mat4",name:"mmx"},vmx:{type:"mat4",name:"vmx"},pmx:{type:"mat4",name:"pmx"},light:{type:"vec3",name:"light"},lcolor:{type:"vec3",name:"lcolor"},diffuse:{type:"vec3",name:"diffuse"},line:{type:"i",name:"line"},lwidth:{type:"f",name:"lwidth"},origin:{type:"vec3",name:"origin"},material:{type:"i",name:"material"},time:{type:"f",name:"time"},specular:{type:"vec3",name:"specular"},value:{type:"f",name:"value"}},"_"===this.name?(this.vert=require("./vert"),this.frag=require("./frag"),this.vload=!0,this.fload=!0,this.program=new ShaderProgram(p,this),this.program.set()):(this.program=new ShaderProgram(p,this),getShadersFromFile(this.name,this,this.program,p.spath)),p.shaders.push(this),this};Shader.prototype.load=function(n,v){void 0!==this.uniforms[n]&&this.program.load(this.uniforms[n],v)},Shader.prototype.ready=function(){return!(!this.vload||!this.fload)},Shader.prototype.start=function(){this.program.start()},Shader.prototype.stop=function(){this.program.stop()},Shader.prototype.destroy=function(){this.program.destroy()},module.exports=Shader},{"./frag":5,"./shaderprogram":12,"./utils":13,"./vert":15}],12:[function(require,module,exports){"use strict";var _require=require("./utils"),loadShader=_require.loadShader,ShaderProgram=function(p,shader){return p.started&&shader?(this.gl=p.gl,this.s=shader,this.prsid=null,this.vxsid=null,this.ftsid=null,this.locations={},this):null};ShaderProgram.prototype.set=function(){this.vxsid=loadShader(this.gl,this.s.vert,this.gl.VERTEX_SHADER),this.ftsid=loadShader(this.gl,this.s.frag,this.gl.FRAGMENT_SHADER),this.prsid=this.gl.createProgram(),this.gl.attachShader(this.prsid,this.vxsid),this.gl.attachShader(this.prsid,this.ftsid);for(var a in this.s.attributes)void 0!==this.s.attributes[a]&&this.gl.bindAttribLocation(this.prsid,this.s.attributes[a].pos,this.s.attributes[a].name);this.gl.linkProgram(this.prsid),this.gl.validateProgram(this.prsid);for(var u in this.s.uniforms)void 0!==this.s.uniforms[u]&&(this.locations[this.s.uniforms[u].name]=this.gl.getUniformLocation(this.prsid,this.s.uniforms[u].name));this.gl.getProgramParameter(this.prsid,this.gl.LINK_STATUS)||console.warn("Unable to initialize the this.s program: "+this.gl.getProgramInfoLog(this.prsid))},ShaderProgram.prototype.start=function(){this.gl.useProgram(this.prsid)},ShaderProgram.prototype.stop=function(){this.gl.useProgram(null)},ShaderProgram.prototype.destroy=function(){this.gl.detachShader(this.prsid,this.vxsid),this.gl.detachShader(this.prsid,this.ftsid),this.gl.deleteShader(this.vxsid),this.gl.deleteShader(this.ftsid),this.gl.deleteProgram(this.prsid)},ShaderProgram.prototype.load=function(u,v){switch(u.type){case"i":this.gl.uniform1i(this.locations[u.name],v);break;case"f":this.gl.uniform1f(this.locations[u.name],v);break;case"vec3":this.gl.uniform3fv(this.locations[u.name],new Float32Array(v));break;case"mat4":this.gl.uniformMatrix4fv(this.locations[u.name],!1,new Float32Array(v))}},module.exports=ShaderProgram},{"./utils":13}],13:[function(require,module,exports){"use strict";var area=function(vertices){for(var ar=0,i=0;i<vertices.length;i++){var j=(i+1)%vertices.length;ar+=vertices[i][0]*vertices[j][1],ar-=vertices[j][0]*vertices[i][1]}return ar/2},convex=function(pt){var a=[pt[1][0]-pt[0][0],pt[1][1]-pt[0][1]],b=[pt[2][0]-pt[1][0],pt[2][1]-pt[1][1]];return a[0]*b[1]-a[1]*b[0]>0},deg=function(r){return r/(Math.PI/180)},divide=function(a,b,dv){return[a[0]*(1-dv)+b[0]*dv,a[1]*(1-dv)+b[1]*dv]},inside=function(p,a){for(var ins=!1,i=0,j=a.length-1;i<a.length;j=i++)a[i][1]>p[1]!=a[j][1]>p[1]&&p[0]<(a[j][0]-a[i][0])*(p[1]-a[i][1])/(a[j][1]-a[i][1])+a[i][0]&&(ins=!ins);return ins},lerp=function(a,b,am){return a+(b-a)*am},map=function(val,v1,v2,v3,v4){return v3+(val-v1)/(v2-v1)*(v4-v3)},max=function(ar,p){return ar.reduce(function(maxV,a){return maxV>=a[p]?maxV:a[p]},-1/0)},min=function(ar,p){return ar.reduce(function(minV,a){return minV<=a[p]?minV:a[p]},1/0)},normalize=function(v){var l=v[0]*v[0]+v[1]*v[1];return l>0?(l=1/Math.sqrt(l),[v[0]*l,v[1]*l]):v},perpendicular=function(a,b,sd){var dl=[b[0]-a[0],b[1]-a[1]],dr=[sd,-1/(dl[1]/dl[0])*sd];return 0===dl[0]?dr=[sd,0]:0===dl[1]&&(dr=[0,sd]),normalize(dr)},rad=function(d){return d*(Math.PI/180)},load=function(url,f){var xh=new XMLHttpRequest;xh.onreadystatechange=function(){if(4===this.readyState){var r=this.response;200!==this.status&&(r={status:this.status}),f(r)}},xh.open("GET",url,!0),xh.send()},loadShader=function(gl,s,t){var id=gl.createShader(t);return gl.shaderSource(id,s),gl.compileShader(id),gl.getShaderParameter(id,gl.COMPILE_STATUS)?id:(console.warn("An error occurred compiling the shaders: "+gl.getShaderInfoLog(id)),gl.deleteShader(id),null)},getShadersFromFile=function(n,sh,p,spath){sh.vload=!1,sh.fload=!1,load(spath+n+".vert",function(s){void 0===s.status&&(sh.vload=!0,sh.vert=s,sh.fload&&p.set())}),load(spath+n+".frag",function(s){void 0===s.status&&(sh.fload=!0,sh.frag=s,sh.vload&&p.set())})};module.exports={area:area,convex:convex,deg:deg,divide:divide,inside:inside,lerp:lerp,map:map,max:max,min:min,perpendicular:perpendicular,rad:rad,load:load,loadShader:loadShader,getShadersFromFile:getShadersFromFile}},{}],14:[function(require,module,exports){"use strict";var Vector=function(){var vs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0];return this.vs=vs,this};Vector.prototype.all=function(vs){return void 0!==vs&&(this.vs=vs),this.vs},Vector.prototype.x=function(x){return void 0!==x&&(this.vs[0]=x),this.vs[0]},Vector.prototype.y=function(y){return void 0!==y&&(this.vs[1]=y),this.vs[1]},Vector.prototype.z=function(z){return void 0!==z&&(this.vs[2]=z),this.vs[2]},Vector.add=function(a,b){return new Vector([a.vs[0]+b.vs[0],a.vs[1]+b.vs[1],a.vs[2]+b.vs[2]])},Vector.cross=function(a,b){return new Vector([a.vs[1]*b.vs[2]-a.vs[2]*b.vs[1],a.vs[2]*b.vs[0]-a.vs[0]*b.vs[2],a.vs[0]*b.vs[1]-a.vs[1]*b.vs[0]])},Vector.div=function(a,b){return new Vector([a.vs[0]/b.vs[0],a.vs[1]/b.vs[1],a.vs[2]/b.vs[2]])},Vector.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},Vector.mul=function(a,b){return new Vector([a.vs[0]*b.vs[0],a.vs[1]*b.vs[1],a.vs[2]*b.vs[2]])},Vector.snormal=function(a,b,c){return Vector.cross(Vector.sub(b,a),Vector.sub(c,a))},Vector.sub=function(a,b){return new Vector([a.vs[0]-b.vs[0],a.vs[1]-b.vs[1],a.vs[2]-b.vs[2]])},Vector.normalize=function(v){var l=v.x()*v.x()+v.y()*v.y()+v.z()*v.z();return l>0?(l=Math.sqrt(l),new Vector([v.x()/l,v.y()/l,v.z()/l])):v},module.exports=Vector},{}],15:[function(require,module,exports){"use strict";module.exports="precision highp float;attribute vec3 p;attribute vec2 t;attribute vec3 n;attribute vec3 c;uniform mat4 mvp;uniform mat4 mmx;uniform mat4 vmx;uniform mat4 pmx;uniform vec3 light;uniform int line;uniform float lwidth;uniform vec3 origin;varying vec2 vT;varying vec3 suN;varying vec3 toL;varying vec3 vC;void main(void) {vT = t;vC = c;if (line == 0) {vec3 wP = (mmx * vec4(p, 1.0)).xyz;suN = (mmx * vec4(n, 0.0)).xyz;toL = light - wP;gl_Position = mvp * vec4(p - origin, 1.0);} else {vec4 wP = mmx * vec4(p, 1.0);suN = (mmx * vec4(vec3(0.0, 0.0, n.z), 0.0)).xyz;toL = light - wP.xyz;vec4 delta = vmx * mmx * vec4(n.xy * lwidth, 0.0, 0.0);vec4 pos = vmx * wP;gl_Position = pmx * (pos + delta);}}"},{}]},{},[7])(7)});
